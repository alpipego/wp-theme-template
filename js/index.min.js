jQuery(document).ready(function(a){function b(){if(!i){i=!0;var b={action:"get_index_posts",offset:h};"undefined"!=typeof query_request&&(b.tax=query_request.tax_query||"",b.post_type=query_request.post_type||""),a.get(ajaxurl,b,function(b){b=a(b),g.append(b),e("all"),g.imagesLoaded(function(){g.isotope("appended",b),g.find(".isotope-hidden").removeClass("isotope-hidden"),h++,i=!1})})}}function c(b,c){b=b||a(".single-full"),n.isotope("once","layoutComplete",function(){g.data("scrolling",!0);var d;d=a(window).outerWidth()>700?a("#nav").outerHeight()+("static"==a("#nav").css("position")?120:0):0,a("html, body").animate({scrollTop:b.offset().top-d},200).promise().then(function(){g.removeData("scrolling"),"undefined"!=typeof c&&c()})}),g.imagesLoaded(function(){g.isotope("layout")})}function d(){var b=100/a(".index-single-post-container").first().clone().appendTo("body").wrap('<div id="widthCalc" style="display: none"></div>').width(),c=a(".index-single-post-container").first().outerWidth();if(a("#widthCalc").remove(),c*b<g.innerWidth())e=c;else var d=c*b-g.innerWidth(),e=c-Math.ceil(d/b);g.isotope({masonry:{columnWidth:e}})}function e(b,c){if("all"==b||"undefined"==typeof b){if("undefined"!=typeof c&&c)return void a(".lazy").each(function(){a(this).attr("src",a(this).data("src")+"?width="+a(this).width())});a('.lazy[src=""]').each(function(){a(this).attr("src",a(this).data("src")+"?width="+a(this).width())})}else b.attr("src",b.data("src")+"?width="+b.width())}function f(b){var c=b.find(a("img"));c.each(function(c,d){var e=a(d).attr("width")||a(d).width();(e>b.width()||0==e)&&(e=b.width()),a(d).attr("src",a(d).data("src")+"?width="+e)})}var g=a("#index-posts"),h=2,i=!1,j=a("#twitter-share").attr("href"),k=a("#facebook-share").attr("href"),l=a("#link-share").attr("href"),m=!1,n=g.isotope({itemSelector:".index-single-post-container",columnWidth:a(".index-single-post-link").width(),resize:!1,isResizeBound:!1});a("#speedTest").on("load",function(){m=(new Date).getTime()-speedTestStart<2500?!1:!0}),a("#pagination").css("visibility","hidden"),e("all"),n.imagesLoaded().progress(function(){d()}),a(window).smartresize(function(){d(),e("all",!0)}),isElementInViewport(a("#pagination"))&&b(),a(document).on("mouseenter",".index-single-post-container:not(.single-full)",function(){a(this).addClass("hover")}).on("mouseleave",".index-single-post-container.hover",function(){a(this).removeClass("hover")}),a(document).on("scroll",function(){if(a(".index-single-post-container").hasClass("single-full")){var d=a(".single-full"),e=d.find(".wp-post-image"),f=d.find(".index-single-post"),h=a(window).scrollTop()+.33*a(window).height(),i=h<d.offset().top-.33*a(window).height()||0===a(window).scrollTop()?"up":"down";g.data("scrolling")||(e[0].getBoundingClientRect().top<f[0].getBoundingClientRect().top&&e.addClass("top"),e[0].getBoundingClientRect().top<115&&e.removeClass("top"),e[0].getBoundingClientRect().bottom>f[0].getBoundingClientRect().bottom&&e.addClass("bottom"),e[0].getBoundingClientRect().bottom>e.height()+115&&e.removeClass("bottom"),(h>=d.offset().top+d.height()||h<d.offset().top-.33*a(window).height()||0===a(window).scrollTop()||a(window).scrollTop()+20>=a(document).height()-a(window).height())&&a.when(d.removeClass("single-full hover").delay(250)).done(function(){g.isotope("layout"),a("#twitter-share").attr("href",j),a("#facebook-share").attr("href",k),a("#link-share").attr("href",l),e.removeClass("sticky top bottom"),"down"===i&&c(d)}))}a(window).scrollTop()>a(document).height()-(m?2*a(window).height():1.5*a(window).height())&&b()}),a(document).on("click",".index-single-post-link",function(b){b.preventDefault();var d=a(this).parents(".index-single-post-container"),h=a(this).siblings(".index-single-content-container"),j=0===a.trim(h.html()).length?!0:!1,k=.2;if(j&&!i&&h.loadie(k),g.data("scrolling",!0),d.addClass("single-full").siblings(".index-single-post-container").removeClass("single-full hover"),g.isotope("layout"),j&&!i){i=!0;var l=window.setInterval(function(){k+=.6>k?.1:.05,k>=1&&(window.clearInterval(l),k=.99),h.loadie(k)},400);a.get(ajaxurl,{action:"get_single_post",post_id:a(this).parents(".index-single-post-container").data("id")},function(a){h.loadie(1).html(a).imagesLoaded(function(){d.hasClass("single-full")||d.addClass("single-full"),c(d,function(){var a=d.find(".wp-post-image");a.addClass("sticky top").css("max-width",d.width()/2),e(a)}),f(d.find(".index-single-content-container")),i=!1,g.removeData("scrolling"),window.clearInterval(l)})}),a.getJSON(ajaxurl,{action:"get_share_urls",post_id:a(this).parents(".index-single-post-container").data("id")},function(b){a("#twitter-share").attr("href",b.twitterUrl),a("#facebook-share").attr("href",b.facebookUrl),a("#link-share").attr("href",b.permalinkUrl)})}else c(null,function(){a(".single-full .wp-post-image").addClass("sticky")})})});